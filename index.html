<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PDF Flipbook</title>
<style>
body { font-family: sans-serif; display: flex; flex-direction: column; align-items: center; margin:0; background:#f0f0f0; padding:20px; }
h1 { text-align:center; }
.flipbook {
  width: 400px; height: 600px;
  perspective: 1500px;
  position: relative;
  margin-top: 20px;
}
.page {
  width: 100%; height: 100%;
  position: absolute;
  backface-visibility: hidden;
  transition: transform 0.8s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  border:1px solid #ccc; border-radius:5px;
  background:#fff;
  transform-style: preserve-3d;
}
canvas { width: 100%; height: 100%; }
.controls { margin-top: 10px; }
button { padding:8px 15px; margin:0 5px; font-size:16px; }
#result { margin-top:10px; text-align:center; word-break: break-word; }
</style>
</head>
<body>

<h1>Web PDF Flipbook</h1>
<input type="file" id="file-input" accept="application/pdf">
<div id="result"></div>

<div class="flipbook" id="flipbook"></div>
<div class="controls">
  <button id="prev">Prev</button>
  <button id="next">Next</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.12.313/pdf.min.js"></script>
<script>
let current = 0;
let pages = [];
const flipbook = document.getElementById('flipbook');
const fileInput = document.getElementById('file-input');
const nextBtn = document.getElementById('next');
const prevBtn = document.getElementById('prev');
const resultDiv = document.getElementById('result');

// Load PDF
fileInput.addEventListener('change', async (e)=>{
  const file = e.target.files[0];
  if(!file) return alert('Select a PDF');

  const reader = new FileReader();
  reader.onload = async function() {
    const pdfData = new Uint8Array(reader.result);
    const pdf = await pdfjsLib.getDocument({data: pdfData}).promise;
    renderPDF(pdf);
  };
  reader.readAsArrayBuffer(file);
});

// Render PDF pages
async function renderPDF(pdf){
  flipbook.innerHTML = '';
  pages = [];

  for(let i=1;i<=pdf.numPages;i++){
    const page = await pdf.getPage(i);
    const viewport = page.getViewport({scale:1.5});
    const canvas = document.createElement('canvas');
    canvas.width = viewport.width;
    canvas.height = viewport.height;
    const context = canvas.getContext('2d');
    await page.render({canvasContext: context, viewport}).promise;

    const pageDiv = document.createElement('div');
    pageDiv.className='page';
    pageDiv.style.transform = i===1 ? 'rotateY(0deg)' : 'rotateY(180deg)';
    pageDiv.appendChild(canvas);
    flipbook.appendChild(pageDiv);
    pages.push(pageDiv);
  }

  current = 0;
  resultDiv.innerHTML = `<p>Flipbook loaded: ${pdf.numPages} pages</p>`;
}

// Flipbook navigation
nextBtn.addEventListener('click', ()=>{
  if(current < pages.length - 1){
    pages[current].style.transform='rotateY(-180deg)';
    current++;
  }
});

prevBtn.addEventListener('click', ()=>{
  if(current > 0){
    current--;
    pages[current].style.transform='rotateY(0deg)';
  }
});
</script>

</body>
</html>
